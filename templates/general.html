{% extends "base.html" %}

{% block content %}
  <h1>Find Potential PIs</h1>

  <form method="get" action="{{ url_for('general') }}" class="filters">
    <label for="school">School:</label>
    <select id="school" name="school">
      <option value="">All</option>
      <option value="Harvard" {% if selected_school == "Harvard" %}selected{% endif %}>Harvard</option>
      <option value="MIT" {% if selected_school == "MIT" %}selected{% endif %}>MIT</option>
      <option value="Stanford" {% if selected_school == "Stanford" %}selected{% endif %}>Stanford</option>
      <option value="Princeton" {% if selected_school == "Princeton" %}selected{% endif %}>Princeton</option>
      <option value="Yale" {% if selected_school == "Yale" %}selected{% endif %}>Yale</option>
    </select>

    <label for="department">Department:</label>
    <select id="department" name="department">
      <option value="">All</option>
      <option value="Math" {% if selected_department == "Math" %}selected{% endif %}>Math</option>
      <option value="Applied Math" {% if selected_department == "Applied Math" %}selected{% endif %}>Applied Math</option>
      <option value="CS" {% if selected_department == "CS" %}selected{% endif %}>CS</option>
      <option value="Bio" {% if selected_department == "Bio" %}selected{% endif %}>Bio</option>
      <option value="Neuroscience" {% if selected_department == "Neuroscience" %}selected{% endif %}>Neuroscience</option>
      <option value="Stats" {% if selected_department == "Stats" %}selected{% endif %}>Stats</option>
      <option value="Physics" {% if selected_department == "Physics" %}selected{% endif %}>Physics</option>
    </select>

    <button type="submit">Apply Filters</button>
  </form>

  <hr>

  {% if faculty_list %}
    {% for pi in faculty_list %}
      <div class="pi-card">
        <h2>{{ pi.name }}</h2>
        <p>{{ pi.title }}</p>
        <p>{{ pi.department }}, {{ pi.school }} â€” {{ pi.location }}</p>
        <p><strong>Research:</strong> {{ pi.research_areas }}</p>
        <p>
          <a href="{{ pi.website }}" target="_blank">Website</a> |
          <a href="mailto:{{ pi.email }}">Email</a>
        </p>

        {% if session.get('user_id') %}
          <form method="post" action="{{ url_for('save_pi', pi_id=pi.id) }}">
            <button type="submit">Save PI</button>
          </form>
        {% else %}
          <p><em>Log in to save this PI.</em></p>
        {% endif %}
      </div>
    {% endfor %}
  {% else %}
    <p>No PIs matched your filters yet.</p>
  {% endif %}
{% endblock %}
