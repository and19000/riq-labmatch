{% extends "base.html" %}
{% block title %}Complete Your Profile{% endblock %}

{% block content %}
<div class="onboarding-container">
  <div class="onboarding-card">
    <h1>Find Your Perfect Lab Match</h1>
    <p class="onboarding-subtitle">Answer 5 quick questions to get matched with Harvard faculty.</p>

    <form method="POST" action="{{ url_for('onboarding') }}" class="onboarding-form">

      <!-- Q1: Research Field -->
      <div class="form-group">
        <label for="research_field">1. What research field interests you most?</label>
        <select name="research_field" id="research_field" required class="form-control">
          <option value="">Select a field...</option>
          <option value="biology" {% if profile and profile.research_field == 'biology' %}selected{% endif %}>Biology &amp; Life Sciences</option>
          <option value="chemistry" {% if profile and profile.research_field == 'chemistry' %}selected{% endif %}>Chemistry</option>
          <option value="physics" {% if profile and profile.research_field == 'physics' %}selected{% endif %}>Physics</option>
          <option value="computer science" {% if profile and profile.research_field == 'computer science' %}selected{% endif %}>Computer Science &amp; AI</option>
          <option value="engineering" {% if profile and profile.research_field == 'engineering' %}selected{% endif %}>Engineering</option>
          <option value="medicine" {% if profile and profile.research_field == 'medicine' %}selected{% endif %}>Medicine &amp; Public Health</option>
          <option value="neuroscience" {% if profile and profile.research_field == 'neuroscience' %}selected{% endif %}>Neuroscience &amp; Psychology</option>
          <option value="economics" {% if profile and profile.research_field == 'economics' %}selected{% endif %}>Economics &amp; Social Sciences</option>
          <option value="mathematics" {% if profile and profile.research_field == 'mathematics' %}selected{% endif %}>Mathematics &amp; Statistics</option>
          <option value="environmental" {% if profile and profile.research_field == 'environmental' %}selected{% endif %}>Environmental Science</option>
          <option value="other" {% if profile and profile.research_field == 'other' %}selected{% endif %}>Other</option>
        </select>
      </div>

      <!-- Q2: Specific Topics (dropdown to avoid typos) -->
      <div class="form-group">
        <label>2. What specific topics interest you? (select all that apply)</label>
        <div class="research-topics-select-wrapper">
          <select name="research_topics" id="research_topics" multiple class="form-control" size="6">
            {% for topic in common_research_topics %}
              <option value="{{ topic }}" {% if profile_research_topics_set and topic in profile_research_topics_set %}selected{% endif %}>{{ topic|replace('_', ' ')|title }}</option>
            {% endfor %}
          </select>
          <small class="form-text">Hold Ctrl/Cmd to select multiple. Or type "Other" below.</small>
          <input type="text" name="research_topics_other" id="research_topics_other" class="form-control" style="margin-top: 0.5rem;"
                 placeholder="Other topics (comma-separated, e.g. your lab technique)"
                 value="{{ profile_research_topics_other or '' }}">
        </div>
      </div>

      <!-- Q2b: Your institution (optional) -->
      <div class="form-group">
        <label for="institution">Your institution (optional)</label>
        <select name="institution" id="institution" class="form-control">
          <option value="">— Select your school —</option>
          {% for school in schools %}
            <option value="{{ school }}" {% if profile and profile.institution == school %}selected{% endif %}>{{ school }}</option>
          {% endfor %}
        </select>
      </div>

      <!-- Q3: Academic Level -->
      <div class="form-group">
        <label for="academic_level">3. What's your current academic level?</label>
        <select name="academic_level" id="academic_level" required class="form-control">
          <option value="">Select level...</option>
          <option value="undergrad" {% if profile and profile.academic_level == 'undergrad' %}selected{% endif %}>Undergraduate</option>
          <option value="masters" {% if profile and profile.academic_level == 'masters' %}selected{% endif %}>Master's Student</option>
          <option value="phd" {% if profile and profile.academic_level == 'phd' %}selected{% endif %}>PhD Student</option>
          <option value="postdoc" {% if profile and profile.academic_level == 'postdoc' %}selected{% endif %}>Postdoc / Early Career</option>
        </select>
      </div>

      <!-- Q4: Work Style -->
      <div class="form-group">
        <label for="work_style">4. What type of research do you prefer?</label>
        <select name="work_style" id="work_style" required class="form-control">
          <option value="">Select preference...</option>
          <option value="experimental" {% if profile and profile.work_style == 'experimental' %}selected{% endif %}>Experimental / Wet Lab</option>
          <option value="computational" {% if profile and profile.work_style == 'computational' %}selected{% endif %}>Computational / Dry Lab</option>
          <option value="both" {% if profile and profile.work_style == 'both' %}selected{% endif %}>Both / No Preference</option>
        </select>
      </div>

      <!-- Q5: Funding -->
      <div class="form-group">
        <label for="needs_funding">5. Do you need a funded position?</label>
        <select name="needs_funding" id="needs_funding" required class="form-control">
          <option value="">Select...</option>
          <option value="yes" {% if profile and profile.needs_funding %}selected{% endif %}>Yes, funding is important</option>
          <option value="no" {% if profile and not profile.needs_funding %}selected{% endif %}>No, I have my own funding or it's flexible</option>
        </select>
      </div>

      <div class="onboarding-actions">
        <button type="submit" class="btn-primary btn-large">Find My Matches</button>
      </div>
    </form>
  </div>
</div>
{% endblock %}
